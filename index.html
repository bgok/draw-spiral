<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
<script>
Onion = function(layers) {
	// TODO Generalize the code to remove the assumptions that we are spiraling clockwise and start moving to the east.
	var	maxValue = Math.pow(2*layers+1, 2) - 1,
		minValue = layers>0 ? Math.pow(2*layers-1,2) : 0,
		brCornerValue = maxValue - 6*layers,
		blCornerValue = maxValue - 4*layers,
		tlCornerValue = maxValue - 2*layers,
		trCornerValue = maxValue,
		innerLayer = layers>0 ? Onion(layers-1) : null;
	
	return {
		getValue: function(row, col) {
			if (row === -layers) { // top row
				return tlCornerValue + col + layers;
			} else if (row === layers) { // bottom row
				return blCornerValue - (col + layers);
			} else if (col === -layers) { // left column
				return tlCornerValue - (row + layers);
			} else if (col === layers) { //right column
				return brCornerValue + row - layers;
			} else {
				return innerLayer.getValue(row, col);
			}
		}
	};
};

function getNumberOfLayersRequired(x) {
	return Math.ceil((Math.ceil(Math.sqrt(x+1)) - 1) / 2);
}

$(function() {
	$("form").submit(function(ev) {
		var $canvas = $("#canvas").text(""),
			$table = $("<table/>").appendTo($canvas),
			stepsToTake = $("[name=steps]").val() - 0,
			dimension = getNumberOfLayersRequired(stepsToTake),
			myOnion = Onion(dimension);
		
		for (var i=-dimension; i<=dimension; i++) {
			var $row = $("<tr/>").appendTo($table);
			for (var j=-dimension; j<=dimension; j++) {
				var val = myOnion.getValue(i,j);
				$("<td>"+ (val<=stepsToTake ? val : "") +"</td>").appendTo($row);
			}
		}
		ev.preventDefault();
		return false;
	});
});


</script>
<style>
td {
	height: 24px;
	width: 24px;
	line-height: 21px;
	border: thin solid black;
	text-align: center;
}
</style>
</head>
<body>
<div id=controls>
<pre>
------------
-Exercise 3-
------------
Write some code that accepts an integer and prints the integers from 0
to that input integer in a spiral format.

For example, if I supplied 24 the output would be:

20 21 21 23 24
19  6  7  8  9
18  5  0  1 10
17  4  3  2 11
16 15 14 13 12

Alternative implementation: Slower, but much less memory required.

</pre>
<form action="#">
	Steps to take: <input name=steps type=text></input>
	Starting direction: <select name="starting-direction" disabled="disabled">
		<option>n</option>
		<option>w</option>
		<option>s</option>
		<option selected="selected">e</option>
	</select>
	<button type="submit">Go</button>
</form>
</div>
<div id=canvas></div>
</body>
</html>